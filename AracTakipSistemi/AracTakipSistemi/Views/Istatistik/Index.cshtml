@{
    ViewData["Title"] = "İstatistikler";
}

<link rel="stylesheet" href="~/css/istatistik.css" />

<div class="istatistik-container">
    <div class="istatistik-form-container">
        <div class="page-header fade-in-up">
            <h2><i class="fas fa-chart-line me-2"></i>İstatistikler</h2>
        </div>
        
        <!-- Excel İndirme Butonu -->
        <div class="text-center mb-4 fade-in-up">
            <form asp-action="ExcelIndir" method="post" style="display: inline;">
                <button type="submit" class="excel-btn">
                    <i class="fas fa-file-excel"></i>
                    Excel'e Aktar
                </button>
            </form>
        </div>
        
        <!-- Ana İstatistik Kartları -->
        <div class="stats-grid fade-in-up">
            <!-- Araç İstatistikleri -->
            <div class="stats-card">
                <i class="fas fa-car"></i>
                <div class="stats-number">@ViewBag.ToplamArac</div>
                <div class="stats-label">TOPLAM ARAÇ</div>
            </div>
            
            <!-- Kullanıcı İstatistikleri -->
            <div class="stats-card">
                <i class="fas fa-users"></i>
                <div class="stats-number">@ViewBag.ToplamKullanici</div>
                <div class="stats-label">TOPLAM KULLANICI</div>
            </div>
            
            <!-- Randevu İstatistikleri -->
            <div class="stats-card">
                <i class="fas fa-calendar-check"></i>
                <div class="stats-number">@ViewBag.ToplamRandevu</div>
                <div class="stats-label">TOPLAM RANDEVU</div>
            </div>
        </div>
        
        <!-- Detay İstatistikler -->
        <div class="row fade-in-up">
            <!-- Araç Detayları -->
            <div class="col-md-6">
                <div class="detail-card">
                    <h4><i class="fas fa-car"></i>Araç Durumları</h4>
                    <table class="stats-table">
                        <tr>
                            <td>Aktif Araçlar</td>
                            <td><strong>@ViewBag.AktifArac</strong></td>
                        </tr>
                        <tr>
                            <td>Kullanımda Araçlar</td>
                            <td><strong>@ViewBag.KullanimdaArac</strong></td>
                        </tr>
                        <tr>
                            <td>Bakımda Araçlar</td>
                            <td><strong>@ViewBag.BakimdaArac</strong></td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <!-- Kullanıcı Detayları -->
            <div class="col-md-6">
                <div class="detail-card">
                    <h4><i class="fas fa-users"></i>Kullanıcı Durumları</h4>
                    <table class="stats-table">
                        <tr>
                            <td>Aktif Kullanıcılar</td>
                            <td><strong>@ViewBag.AktifKullanici</strong></td>
                        </tr>
                        <tr>
                            <td>Pasif Kullanıcılar</td>
                            <td><strong>@ViewBag.PasifKullanici</strong></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="row fade-in-up">
            <!-- Randevu Detayları -->
            <div class="col-md-6">
                <div class="detail-card">
                    <h4><i class="fas fa-calendar-check"></i>Randevu Durumları</h4>
                    <table class="stats-table">
                        <tr>
                            <td>Bekleyen Randevular</td>
                            <td><strong>@ViewBag.BekleyenRandevu</strong></td>
                        </tr>
                        <tr>
                            <td>Onaylanan Randevular</td>
                            <td><strong>@ViewBag.OnaylananRandevu</strong></td>
                        </tr>
                        <tr>
                            <td>Reddedilen Randevular</td>
                            <td><strong>@ViewBag.ReddedilenRandevu</strong></td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <!-- En Çok Kullanılan Araçlar -->
            <div class="col-md-6">
                <div class="detail-card">
                    <h4><i class="fas fa-star"></i>En Çok Kullanılan Araçlar</h4>
                    <table class="stats-table">
                        <thead>
                            <tr>
                                <th>Araç</th>
                                <th>Kullanım</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (ViewBag.EnCokKullanilanAraclar != null)
                            {
                                foreach (var arac in ViewBag.EnCokKullanilanAraclar)
                                {
                                    <tr>
                                        <td>@arac.Arac.Plaka</td>
                                        <td><strong>@arac.KullanimSayisi kez</strong></td>
                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Departman İstatistikleri -->
        <div class="fade-in-up">
            <div class="detail-card">
                <h4><i class="fas fa-building"></i>Departman Bazlı İstatistikler</h4>
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>Departman</th>
                            <th>Toplam Randevu</th>
                            <th>Onaylanan</th>
                            <th>Bekleyen</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (ViewBag.DepartmanIstatistikleri != null)
                        {
                            foreach (var dept in ViewBag.DepartmanIstatistikleri)
                            {
                                <tr>
                                    <td>@dept.Departman</td>
                                    <td><strong>@dept.RandevuSayisi</strong></td>
                                    <td><strong>@dept.OnaylananSayisi</strong></td>
                                    <td><strong>@dept.BekleyenSayisi</strong></td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div> 